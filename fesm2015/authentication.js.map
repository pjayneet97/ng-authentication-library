{"version":3,"file":"authentication.js","sources":["ng://authentication/lib/authentication.service.ts","ng://authentication/lib/authentication.component.ts","ng://authentication/lib/authentication.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { auth } from 'firebase/app';\nimport * as firebase from 'firebase'; \n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class AuthenticationService {\n  authInfo=null;\n  windowRef:any;\n  mode;\n  authType=null;\n  constructor(public afAuth:AngularFireAuth) {\n    this.windowRef = window;\n    afAuth.authState.subscribe(res=>{\n      this.authInfo=res;\n      if(this.authType=='email'){\n        if(res){\n          if(res.emailVerified){\n            this.mode='successful'\n          }\n          else{\n            this.mode='emailverify'\n          }\n        }\n      }\n      else if(this.authType=='phone'){\n        this.mode='successful';\n      }\n    })\n   }\n\n  isAuthenticated(){\n    if(this.authInfo){\n      return true;\n    }\n    else{\n      return false;\n    }\n  }\n  googleLogin() {\n    this.authType='email';\n    return this.afAuth.auth.signInWithPopup(new auth.GoogleAuthProvider())\n  }\n  loginWithEmail(email:string,password:string){\n    this.authType='email';\n    return this.afAuth.auth.signInWithEmailAndPassword(email,password);\n  }\n  createUserWithEmail(email,password,photoURL,displayName){\n    this.authType='email';\n    return this.afAuth.auth.createUserWithEmailAndPassword(email,password).then(res=>{\n      this.updateProfile(displayName,photoURL);\n      this.sendEmailVerification()\n    })\n  }\n  signInWithPhone(phoneNo) {\n    this.authType='phone';\n    const appVerifier = this.windowRef.recaptchaVerifier;\n    return this.afAuth.auth.signInWithPhoneNumber(phoneNo,appVerifier)\n  }\n\n  resend(phoneNo){\n    this.authType='phone'\n    const appVerifier = this.windowRef.recaptchaVerifier;\n    return this.afAuth.auth.signInWithPhoneNumber(phoneNo,appVerifier)\n  }\n\n  verifyOTP(otp) {\n    this.authType='phone';\n    return this.windowRef.confirmationResult.confirm(otp)\n  }\n\n  logOut() {\n    this.authInfo=null;\n    return this.afAuth.auth.signOut();\n  }\n  getauthDetails(){\n    return this.authInfo;\n  }\n  sendEmailVerification(){\n    this.afAuth.auth.currentUser.sendEmailVerification()\n  }\n  updateProfile(displayName,photoURL){\n    return this.afAuth.auth.currentUser.updateProfile({displayName,photoURL})\n  }\n  updatePassword(newPassword){\n    return this.afAuth.auth.currentUser.updatePassword(newPassword)\n  }\n  isEmailVerified(){\n    return this.authInfo.emailVerified\n  }\n\n\n\n  \n}\n","import { Component, OnInit } from '@angular/core';\nimport { AuthenticationService } from './authentication.service';\nimport * as firebase from 'firebase';\n@Component({\n  selector: 'lib-authentication',\n  templateUrl: './authentication.component.html',\n  styleUrls: ['./authentication.component.scss']\n})\nexport class AuthenticationComponent implements OnInit {\n  phone\n  loading=false;\n  constructor(public auth:AuthenticationService) { }\n\n  ngOnInit() {\n    this.auth.mode='emaillogin';\n    this.auth.windowRef.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha', {\n      size: 'invisible',\n      callback(response) {\n        // reCAPTCHA solved, allow signInWithPhoneNumber.\n        this.auth.signInWithPhone();\n      }\n    });\n    this.auth.windowRef.recaptchaVerifier.render();\n  }\n  signInWithGoogle(){\n    this.loading=true;\n    this.auth.googleLogin().then(res=>{\n      this.loading=false\n      console.log(res)\n    }).catch(err=>{\n      alert(\"error\")\n      this.loading=false;\n    })\n  }\n  signInWithEmail(formData){\n    this.loading=true;\n    this.auth.loginWithEmail(formData.email,formData.password).then(res=>{\n      console.log(res)\n      this.loading=false;\n    })\n  }\n\n  logOut(){\n    this.loading=true;\n    this.auth.logOut().then(res=>{\n      this.auth.mode='emaillogin';\n      this.loading=false\n    })\n  }\n\n  sendOTP(formData) {\n    if (formData.phone) { \n      this.loading=true;\n       this.phone = '+91' + formData.phone.toString();\n      this.auth.signInWithPhone(this.phone).then(result => {\n      this.auth.windowRef.confirmationResult = result;\n      this.auth.mode='verifyotp'\n      this.loading=false;\n      console.log(\"otp Sent\")\n    })\n    .catch( error => {\n      console.log(error);\n      alert(\"error occoured\");\n      this.loading=false\n    }); }\n  }\n\n  varify(otp) {\n    if (otp) {\n      this.auth.verifyOTP(otp.toString());\n    }\n  }\n  resend(){\n    this.auth.resend(this.phone);\n  }\n  signupwithemail(formData){\n    this.loading=true\n    this.auth.createUserWithEmail(formData.email,formData.password,\"\",formData.name).then(res=>{\n      this.loading=false\n    })\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { AuthenticationComponent } from './authentication.component';\nimport { AngularFireModule } from '@angular/fire';\nimport { AngularFireAuthModule } from '@angular/fire/auth';\nimport { CommonModule } from '@angular/common';  \n\nimport { FormsModule }   from '@angular/forms';\n\n\n@NgModule({\n  declarations: [AuthenticationComponent],\n  imports: [\n    AngularFireModule.initializeApp({\n      apiKey: \"AIzaSyCG0rcc-R7bBSSgoJD4V7FsEW9S_rCvPgc\",\n      authDomain: \"chat-8a723.firebaseapp.com\",\n      databaseURL: \"https://chat-8a723.firebaseio.com\",\n      projectId: \"chat-8a723\",\n      storageBucket: \"chat-8a723.appspot.com\",\n      messagingSenderId: \"868038804017\",\n      appId: \"1:868038804017:web:e0f3f645ba1e06a2948b10\",\n      measurementId: \"G-RFY323LJ3K\"\n    }),\n    AngularFireAuthModule,\n    CommonModule,\n    FormsModule\n  ],\n  exports: [AuthenticationComponent]\n})\nexport class AuthenticationModule { }\n"],"names":["firebase.auth"],"mappings":"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"}